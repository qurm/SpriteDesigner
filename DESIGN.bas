    5 MODE2:VDU23;8202;0;0;0;
    6 HIMEM=&3000
    7 L%=&1900:U%=0:@%=6
    8 ONERRORGOTO200
    9 *FX4,1
   10 PROCDUMP
   15 PRINTTAB(4,19)"E";TAB(10)"R"
   16 PRINTTAB(0,7)
   20 SCRLON%=&4840
  100 REPEAT:PROCSHAPE
  115   IFINKEY(-104) L%=L%+128
  116   IFINKEY(-86) L%=L%+64
  117   IFINKEY(-103) L%=L%-128
  118   IFINKEY(-101) L%=L%-8
  120   IFINKEY(-99) L%=L%+8
  121   IFINKEY(-51)PROCDUMP
  125   IFINKEY(-35)PROCENLARGE(&5320)
  126   IFINKEY(-52)PROCENLARGE(&5460)
  128   IFINKEY(-66)GOTO280
  150 UNTILINKEY(-17)
  200 *FX15,1
  210 *FX4,0
  220 END
  280 A%=0:X%=0:Y%=0
  290 REPEAT K=0
  300   REPEAT
  302     FORY=0TO40:NEXT
  304     IFINKEY(-26) X%=X%-1:K=-1
  306     IFINKEY(-58) Y%=Y%-1:K=-1
  308     IFINKEY(-122) X%=X%+1:K=-1
  310     IFINKEY(-42) Y%=Y%+1:K=-1
  312     IFINKEY(-17) K=-1
  330     X%=X%AND15:Y%=Y%AND7
  335     A%=16*X%+640*(Y%DIV2)+4*(Y%AND1)
  337     PICOL%=A%?&5320
  340     PROCFILLPIX(&5320+A%,PICOL%EOR255)
  345     FORY=0TO40:NEXT
  347     PROCSELECT
  350     PROCFILLPIX(&5320+A%,PICOL%)
  380   UNTILK
  400 UNTILINKEY(-17)
  410 PRINTTAB(0,11)"SAVE AT";~L%"?";CHR$(13);
  420 *FX15,1
  425 G=GET
  430 IF(G=64)OR(G=89) PROCSAVE(G)
  450 PRINT"             "
  460 GOTO100
  600 DEFPROCSHAPE
  620 FORA%=0TO63:A%?SCRLON%=A%?L%
  630   REMA%?(SCRLON%+640)=A%?(L%+32):NEXT
  635 NEXT
  640 PRINTTAB(0,9)L%,~L%
  650 ENDPROC
  700 DEFPROCENLARGE(TPLFT%)
  701 FORH%=0TO0
  702   EN%=TPLFT%+H%*&A00:L%=L%+H%*32
  710   FORA%=0TO63
  715     J%=A%AND6
  725     REMIF(A%MOD2) INC%=4+J%*320+(A%DIV8)*32 ELSE INC%=J%*320+(A%DIV8)*32
  726     IF(A%AND1) INC%=4+J%*320+(A%DIV8)*32 ELSE INC%=J%*320+(A%DIV8)*32
  730     COL%=A%?L%:PROCSPLITBYTE(COL%)
  740     LCOL%=LCOL% OR(LCOL%*2)
  750     RCOL%=RCOL% OR(RCOL%*2)
  755     PROCFILLPIX(EN%+INC%,LCOL%)
  770     PROCFILLPIX(EN%+INC%+16,RCOL%)
  790   NEXTA%:NEXTH%
  795 ENDPROC
  800 DEFPROCDUMP
  805 B%=&1900:E%=&1E00
  810 FORA%=0TO(E%-B%):A%?&3000=A%?B%
  840 NEXT:PRINTTAB(0,27);
  842 FORB%=0TO15:COLOUR(128+B%):VDU32:NEXT
  845 COLOUR128:ENDPROC
  850 DEFPROCFILLPIX(D%,C%)
  860 FORT%=0TO3:T%?D%=C%:T%?(D%+8)=C%
  870 NEXT:ENDPROC
  900 DEFPROCSPLITBYTE(BY%)
  910 RCOL%=(BY%AND&55)
  920 LCOL%=(BY%AND&AA)/2
  930 ENDPROC
  950 DEFPROCSELECT
  960 PRINTTAB(U%,28)" "
  965 IFINKEY(-103)U%=U%-1
  966 IFINKEY(-104)U%=U%+1
  968 U%=U%AND15
  970 PRINTTAB(U%,28)"."
  980 IFINKEY(-106) PICOL%=?(U%*32+&7383):PROCREDUCE
  990 ENDPROC
 1000 DEFPROCREDUCE
 1010 IF(X%AND1) PIX%=(PICOL%AND&55)OR((A%?&5310)AND&AA) ELSE PIX%=(PICOL%AND&AA)OR((A%?&5330)AND&55)
 1020 ?(SCRLON%+(X%DIV2)*8+(Y%AND7)+(Y%DIV8)*640)=PIX%
 1040 ENDPROC
 1100 DEFPROCSAVE(CH)
 1105 IFCH=64 PRINT"              "CHR$(13);:INPUT"  AT ",H$:VDU11:L%=EVAL(H$)
 1110 FORA%=0TO63:A%?L%=A%?SCRLON%:NEXT
 1150 ENDPROC
